// All the authentication logic here